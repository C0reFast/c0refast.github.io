<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/favicon-orgin.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="mask-icon" href="/images/favicon/favicon-orgin.png" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.31/dist/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.ichenfu.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="最近公司有个Ceph集群出了点问题，于是也参与了修复的过程，过程中最让人头疼的就是一堆不明所以的状态了，所以看了看文档，也找了一些参考，整理了一下Ceph PG的一些状态以及相关的概念说明，做了一个中英文的对照版本： Placement Group States（PG状态）当检查一个集群的状态时（执行ceph -w或者ceph -s），Ceph会汇报当前PG的状态，每个PG会有一个或多个状态，最优">
<meta property="og:type" content="article">
<meta property="og:title" content="Ceph中一些PG相关的状态说明和基本概念说明">
<meta property="og:url" content="https://www.ichenfu.com/2018/07/06/ceph-pg-states-concepts/index.html">
<meta property="og:site_name" content="C0reFast记事本">
<meta property="og:description" content="最近公司有个Ceph集群出了点问题，于是也参与了修复的过程，过程中最让人头疼的就是一堆不明所以的状态了，所以看了看文档，也找了一些参考，整理了一下Ceph PG的一些状态以及相关的概念说明，做了一个中英文的对照版本： Placement Group States（PG状态）当检查一个集群的状态时（执行ceph -w或者ceph -s），Ceph会汇报当前PG的状态，每个PG会有一个或多个状态，最优">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-07-06T02:23:50.000Z">
<meta property="article:modified_time" content="2020-10-12T01:50:42.290Z">
<meta property="article:author" content="陈孚">
<meta property="article:tag" content="Ceph">
<meta property="article:tag" content="PG States">
<meta property="article:tag" content="PG Concepts">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.ichenfu.com/2018/07/06/ceph-pg-states-concepts/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.ichenfu.com/2018/07/06/ceph-pg-states-concepts/","path":"2018/07/06/ceph-pg-states-concepts/","title":"Ceph中一些PG相关的状态说明和基本概念说明"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Ceph中一些PG相关的状态说明和基本概念说明 | C0reFast记事本</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-47062085-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-47062085-1","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?50e2a95e85fdbe38e53b7aaba8c6cfe1"></script>







  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="C0reFast记事本" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">C0reFast记事本</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">to inspire confidence in somebody.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Placement-Group-States%EF%BC%88PG%E7%8A%B6%E6%80%81%EF%BC%89"><span class="nav-number">1.</span> <span class="nav-text">Placement Group States（PG状态）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#creating"><span class="nav-number">1.0.1.</span> <span class="nav-text">creating</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#activating"><span class="nav-number">1.0.2.</span> <span class="nav-text">activating</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#active"><span class="nav-number">1.0.3.</span> <span class="nav-text">active</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#clean"><span class="nav-number">1.0.4.</span> <span class="nav-text">clean</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#down"><span class="nav-number">1.0.5.</span> <span class="nav-text">down</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#scrubbing"><span class="nav-number">1.0.6.</span> <span class="nav-text">scrubbing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#deep"><span class="nav-number">1.0.7.</span> <span class="nav-text">deep</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#degraded"><span class="nav-number">1.0.8.</span> <span class="nav-text">degraded</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#inconsistent"><span class="nav-number">1.0.9.</span> <span class="nav-text">inconsistent</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#peering"><span class="nav-number">1.0.10.</span> <span class="nav-text">peering</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#repair"><span class="nav-number">1.0.11.</span> <span class="nav-text">repair</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#recovering"><span class="nav-number">1.0.12.</span> <span class="nav-text">recovering</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#forced-recovery"><span class="nav-number">1.0.13.</span> <span class="nav-text">forced_recovery</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#recovery-wait"><span class="nav-number">1.0.14.</span> <span class="nav-text">recovery_wait</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#recovery-toofull"><span class="nav-number">1.0.15.</span> <span class="nav-text">recovery_toofull</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#recovery-unfound"><span class="nav-number">1.0.16.</span> <span class="nav-text">recovery_unfound</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#backfilling"><span class="nav-number">1.0.17.</span> <span class="nav-text">backfilling</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#forced-backfill"><span class="nav-number">1.0.18.</span> <span class="nav-text">forced_backfill</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#backfill-wait"><span class="nav-number">1.0.19.</span> <span class="nav-text">backfill_wait</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#backfill-toofull"><span class="nav-number">1.0.20.</span> <span class="nav-text">backfill_toofull</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#backfill-unfound"><span class="nav-number">1.0.21.</span> <span class="nav-text">backfill_unfound</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#incomplete"><span class="nav-number">1.0.22.</span> <span class="nav-text">incomplete</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#stale"><span class="nav-number">1.0.23.</span> <span class="nav-text">stale</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#remapped"><span class="nav-number">1.0.24.</span> <span class="nav-text">remapped</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#undersized"><span class="nav-number">1.0.25.</span> <span class="nav-text">undersized</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#peered"><span class="nav-number">1.0.26.</span> <span class="nav-text">peered</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#snaptrim"><span class="nav-number">1.0.27.</span> <span class="nav-text">snaptrim</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#snaptrim-Wait"><span class="nav-number">1.0.28.</span> <span class="nav-text">snaptrim_Wait</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#snaptrim-Error"><span class="nav-number">1.0.29.</span> <span class="nav-text">snaptrim_Error</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Placement-Group-Concepts%EF%BC%88PG%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%EF%BC%89"><span class="nav-number">2.</span> <span class="nav-text">Placement Group Concepts（PG相关概念）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Peering-%E5%BB%BA%E7%AB%8B%E4%BA%92%E8%81%94"><span class="nav-number">2.0.1.</span> <span class="nav-text">Peering (建立互联)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Acting-Set-%E5%9C%A8%E4%BB%BB%E9%9B%86%E5%90%88"><span class="nav-number">2.0.2.</span> <span class="nav-text">Acting Set (在任集合)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Up-Set-%E5%BD%93%E9%80%89%E9%9B%86%E5%90%88"><span class="nav-number">2.0.3.</span> <span class="nav-text">Up Set (当选集合)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Current-Interval-or-Past-Interval"><span class="nav-number">2.0.4.</span> <span class="nav-text">Current Interval or Past Interval</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Primary-%E4%B8%BB-OSD"><span class="nav-number">2.0.5.</span> <span class="nav-text">Primary (主 OSD)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replica-%E5%89%AF%E6%9C%AC-OSD"><span class="nav-number">2.0.6.</span> <span class="nav-text">Replica (副本 OSD)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Stray-%E5%BD%B7%E5%BE%A8-OSD"><span class="nav-number">2.0.7.</span> <span class="nav-text">Stray (彷徨 OSD)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Recovery-%E6%81%A2%E5%A4%8D"><span class="nav-number">2.0.8.</span> <span class="nav-text">Recovery (恢复)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PG-Info-PG-%E4%BF%A1%E6%81%AF"><span class="nav-number">2.0.9.</span> <span class="nav-text">PG Info (PG 信息)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#PG-Log-PG-%E6%97%A5%E5%BF%97"><span class="nav-number">2.0.9.1.</span> <span class="nav-text">PG Log (PG 日志)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Missing-Set-%E7%BC%BA%E5%A4%B1%E9%9B%86%E5%90%88"><span class="nav-number">2.0.10.</span> <span class="nav-text">Missing Set (缺失集合)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Authoritative-History-%E6%9D%83%E5%A8%81%E5%8E%86%E5%8F%B2"><span class="nav-number">2.0.11.</span> <span class="nav-text">Authoritative History (权威历史)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Epoch-%E5%85%83%E7%89%88%E6%9C%AC"><span class="nav-number">2.0.12.</span> <span class="nav-text">Epoch (元版本)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Last-Epoch-Start-%E6%9C%80%E6%96%B0%E8%B5%B7%E5%A7%8B%E5%85%83%E7%89%88%E6%9C%AC"><span class="nav-number">2.0.13.</span> <span class="nav-text">Last Epoch Start (最新起始元版本)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#up-thru-%E9%A2%86%E5%AF%BC%E6%8B%8D%E6%9D%BF"><span class="nav-number">2.0.14.</span> <span class="nav-text">up_thru (领导拍板)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Last-Epoch-Clean-%E6%9C%80%E6%96%B0%E5%B9%B2%E5%87%80%E5%85%83%E7%89%88%E6%9C%AC"><span class="nav-number">2.0.15.</span> <span class="nav-text">Last Epoch Clean (最新干净元版本)</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">陈孚</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">104</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">230</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/C0reFast" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;C0reFast" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:chenfu@ichenfu.com" title="E-Mail → mailto:chenfu@ichenfu.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/c0refast" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;c0refast" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://www.aikaiyuan.com/" title="https:&#x2F;&#x2F;www.aikaiyuan.com&#x2F;" rel="noopener" target="_blank">爱开源</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://blog.yiranzai.top/" title="https:&#x2F;&#x2F;blog.yiranzai.top&#x2F;" rel="noopener" target="_blank">一冉再</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://www.cnblogs.com/pikachuworld/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;pikachuworld&#x2F;" rel="noopener" target="_blank">PikachuWorld</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.ichenfu.com/2018/07/06/ceph-pg-states-concepts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="陈孚">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="C0reFast记事本">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Ceph中一些PG相关的状态说明和基本概念说明 | C0reFast记事本">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Ceph中一些PG相关的状态说明和基本概念说明
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018年7月6日 10:23 10:23:50" itemprop="dateCreated datePublished" datetime="2018-07-06T10:23:50+08:00">2018年7月6日 10:23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020年10月12日 9:50 9:50:42" itemprop="dateModified" datetime="2020-10-12T09:50:42+08:00">2020年10月12日 9:50</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Ceph/" itemprop="url" rel="index"><span itemprop="name">Ceph</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>最近公司有个Ceph集群出了点问题，于是也参与了修复的过程，过程中最让人头疼的就是一堆不明所以的状态了，所以看了看文档，也找了一些参考，<br>整理了一下Ceph PG的一些状态以及相关的概念说明，做了一个中英文的对照版本：</p>
<h2 id="Placement-Group-States（PG状态）"><a href="#Placement-Group-States（PG状态）" class="headerlink" title="Placement Group States（PG状态）"></a>Placement Group States（PG状态）</h2><p>当检查一个集群的状态时（执行<code>ceph -w</code>或者<code>ceph -s</code>），Ceph会汇报当前PG的状态，每个PG会有一个或多个状态，最优的PG状态是<code>active + clean</code>。<br>下面是所有PG状态的具体解释：</p>
<h4 id="creating"><a href="#creating" class="headerlink" title="creating"></a><em>creating</em></h4><pre><code>Ceph is still creating the placement group.
Ceph 仍在创建PG。
</code></pre>
<h4 id="activating"><a href="#activating" class="headerlink" title="activating"></a><em>activating</em></h4><pre><code>The placement group is peered but not yet active.
PG已经互联，但是还没有active。
</code></pre>
<h4 id="active"><a href="#active" class="headerlink" title="active"></a><em>active</em></h4><pre><code>Ceph will process requests to the placement group.
Ceph 可处理到此PG的请求。
</code></pre>
<h4 id="clean"><a href="#clean" class="headerlink" title="clean"></a><em>clean</em></h4><pre><code>Ceph replicated all objects in the placement group the correct
number of times.
PG内所有的对象都被正确的复制了对应的份数。
</code></pre>
<h4 id="down"><a href="#down" class="headerlink" title="down"></a><em>down</em></h4><pre><code>A replica with necessary data is down, so the placement group is
offline.
一个包含必备数据的副本离线，所以PG也离线了。
</code></pre>
<h4 id="scrubbing"><a href="#scrubbing" class="headerlink" title="scrubbing"></a><em>scrubbing</em></h4><pre><code>Ceph is checking the placement group metadata for inconsistencies.
Ceph 正在检查PG metadata的一致性。
</code></pre>
<h4 id="deep"><a href="#deep" class="headerlink" title="deep"></a><em>deep</em></h4><pre><code>Ceph is checking the placement group data against stored checksums.
Ceph 正在检查PG数据和checksums的一致性。
</code></pre>
<h4 id="degraded"><a href="#degraded" class="headerlink" title="degraded"></a><em>degraded</em></h4><pre><code>Ceph has not replicated some objects in the placement group the
correct number of times yet.
PG中的一些对象还没有被复制到规定的份数。
</code></pre>
<h4 id="inconsistent"><a href="#inconsistent" class="headerlink" title="inconsistent"></a><em>inconsistent</em></h4><pre><code>Ceph detects inconsistencies in the one or more replicas of an
object in the placement group (e.g. objects are the wrong size,
objects are missing from one replica *after* recovery finished,
etc.).
Ceph检测到PG中对象的一份或多份数据不一致（比如对象大学不一直，或者恢复成功后对象依然没有等）
</code></pre>
<h4 id="peering"><a href="#peering" class="headerlink" title="peering"></a><em>peering</em></h4><pre><code>The placement group is undergoing the peering process
PG正在互联过程中。
</code></pre>
<span id="more"></span>

<h4 id="repair"><a href="#repair" class="headerlink" title="repair"></a><em>repair</em></h4><pre><code>Ceph is checking the placement group and repairing any
inconsistencies it finds (if possible).
Ceph正在检查PG并且修复所有发现的不一致情况（如果有的话）。
</code></pre>
<h4 id="recovering"><a href="#recovering" class="headerlink" title="recovering"></a><em>recovering</em></h4><pre><code>Ceph is migrating/synchronizing objects and their replicas.
Ceph正在迁移/同步对象和其副本。
</code></pre>
<h4 id="forced-recovery"><a href="#forced-recovery" class="headerlink" title="forced_recovery"></a><em>forced_recovery</em></h4><pre><code>High recovery priority of that PG is enforced by user.
用户指定的PG高优先级恢复
</code></pre>
<h4 id="recovery-wait"><a href="#recovery-wait" class="headerlink" title="recovery_wait"></a><em>recovery_wait</em></h4><pre><code>The placement group is waiting in line to start recover.
PG正在等待恢复被调度执行。
</code></pre>
<h4 id="recovery-toofull"><a href="#recovery-toofull" class="headerlink" title="recovery_toofull"></a><em>recovery_toofull</em></h4><pre><code>A recovery operation is waiting because the destination OSD is over
its full ratio.
恢复操作因为目标OSD容量超过指标而挂起。
</code></pre>
<h4 id="recovery-unfound"><a href="#recovery-unfound" class="headerlink" title="recovery_unfound"></a><em>recovery_unfound</em></h4><pre><code>Recovery stopped due to unfound objects.
恢复因为没有找到对应对象而停止。
</code></pre>
<h4 id="backfilling"><a href="#backfilling" class="headerlink" title="backfilling"></a><em>backfilling</em></h4><pre><code>Ceph is scanning and synchronizing the entire contents of a
placement group instead of inferring what contents need to be
synchronized from the logs of recent operations. Backfill is a
special case of recovery.
Ceph正常扫描并同步整个PG的数据，而不是从最近的操作日志中推断需要同步的数据，Backfill（回填）是恢复的一个特殊状态。
</code></pre>
<h4 id="forced-backfill"><a href="#forced-backfill" class="headerlink" title="forced_backfill"></a><em>forced_backfill</em></h4><pre><code>High backfill priority of that PG is enforced by user.
用户指定的高优先级backfill。
</code></pre>
<h4 id="backfill-wait"><a href="#backfill-wait" class="headerlink" title="backfill_wait"></a><em>backfill_wait</em></h4><pre><code>The placement group is waiting in line to start backfill.
PG正在等待backfill被调度执行。
</code></pre>
<h4 id="backfill-toofull"><a href="#backfill-toofull" class="headerlink" title="backfill_toofull"></a><em>backfill_toofull</em></h4><pre><code>A backfill operation is waiting because the destination OSD is over
its full ratio.
backfill操作因为目标OSD容量超过指标而挂起。
</code></pre>
<h4 id="backfill-unfound"><a href="#backfill-unfound" class="headerlink" title="backfill_unfound"></a><em>backfill_unfound</em></h4><pre><code>Backfill stopped due to unfound objects.
Backfill因为没有找到对应对象而停止。
</code></pre>
<h4 id="incomplete"><a href="#incomplete" class="headerlink" title="incomplete"></a><em>incomplete</em></h4><pre><code>Ceph detects that a placement group is missing information about
writes that may have occurred, or does not have any healthy copies.
If you see this state, try to start any failed OSDs that may contain
the needed information. In the case of an erasure coded pool
temporarily reducing min\_size may allow recovery.
Ceph 探测到某一PG可能丢失了写入信息，或者没有健康的副本。如果你看到了这个状态，尝试启动有可能包含所需信息的失败OSD，
如果是erasure coded pool的话，临时调整一下`min_size`也可能完成恢复。
</code></pre>
<h4 id="stale"><a href="#stale" class="headerlink" title="stale"></a><em>stale</em></h4><pre><code>The placement group is in an unknown state - the monitors have not
received an update for it since the placement group mapping changed.
PG状态未知，从PG mapping更新后Monitor一直没有收到更新。
</code></pre>
<h4 id="remapped"><a href="#remapped" class="headerlink" title="remapped"></a><em>remapped</em></h4><pre><code>The placement group is temporarily mapped to a different set of OSDs
from what CRUSH specified.
PG被临时分配到了和CRUSH所指定的不同的OSD上。
</code></pre>
<h4 id="undersized"><a href="#undersized" class="headerlink" title="undersized"></a><em>undersized</em></h4><pre><code>The placement group has fewer copies than the configured pool
replication level.
该PG的副本数量小于存储池所配置的副本数量。
</code></pre>
<h4 id="peered"><a href="#peered" class="headerlink" title="peered"></a><em>peered</em></h4><pre><code>The placement group has peered, but cannot serve client IO due to
not having enough copies to reach the pool\&#39;s configured min\_size
parameter. Recovery may occur in this state, so the pg may heal up
to min\_size eventually.
PG已互联，但是不能向客户端提供服务，因为其副本数没达到本存储池的配置值（ min_size 参数）。
在此状态下恢复会进行，所以此PG最终能达到 min_size 。
</code></pre>
<h4 id="snaptrim"><a href="#snaptrim" class="headerlink" title="snaptrim"></a><em>snaptrim</em></h4><pre><code>Trimming snaps.
正在对快照做Trim操作。
</code></pre>
<h4 id="snaptrim-Wait"><a href="#snaptrim-Wait" class="headerlink" title="snaptrim_Wait"></a><em>snaptrim_Wait</em></h4><pre><code>Queued to trim snaps.
Trim操作等待被调度执行
</code></pre>
<h4 id="snaptrim-Error"><a href="#snaptrim-Error" class="headerlink" title="snaptrim_Error"></a><em>snaptrim_Error</em></h4><pre><code>Error stopped trimming snaps.
Trim操作因为错误而停止
</code></pre>
<h2 id="Placement-Group-Concepts（PG相关概念）"><a href="#Placement-Group-Concepts（PG相关概念）" class="headerlink" title="Placement Group Concepts（PG相关概念）"></a>Placement Group Concepts（PG相关概念）</h2><p>When you execute commands like <code>ceph -w</code>, <code>ceph osd dump</code>, and other<br>commands related to placement groups, Ceph may return values using some<br>of the following terms:<br>当执行诸如<code>ceph -w</code>、<code>ceph osd dump</code>及其他和归置组相关的命令时， Ceph 会返回下列术语：</p>
<h4 id="Peering-建立互联"><a href="#Peering-建立互联" class="headerlink" title="Peering (建立互联)"></a><em>Peering</em> (<em>建立互联</em>)</h4><pre><code>The process of bringing all of the OSDs that store a Placement Group
(PG) into agreement about the state of all of the objects (and their
metadata) in that PG. Note that agreeing on the state does not mean
that they all have the latest contents.
表示所有存储PG数据的OSD达成对PG中所有对象（和元数据）共识的过程。
需要注意的是达成共识并不代表他们都拥有最新的数据。
</code></pre>
<h4 id="Acting-Set-在任集合"><a href="#Acting-Set-在任集合" class="headerlink" title="Acting Set (在任集合)"></a><em>Acting Set</em> (<em>在任集合</em>)</h4><pre><code>The ordered list of OSDs who are (or were as of some epoch)
responsible for a particular placement group.
一个OSD的有序集合，他们为一个PG（或者一些版本）负责。
</code></pre>
<h4 id="Up-Set-当选集合"><a href="#Up-Set-当选集合" class="headerlink" title="Up Set (当选集合)"></a><em>Up Set</em> (<em>当选集合</em>)</h4><pre><code>The ordered list of OSDs responsible for a particular placement
group for a particular epoch according to CRUSH. Normally this is
the same as the *Acting Set*, except when the *Acting Set* has been
explicitly overridden via `pg_temp` in the OSD Map.
一列有序OSD ，它们依据 CRUSH 算法为某一PG的特定元版本负责。
它通常和*Acting Set*相同，除非*Acting Set*被OSD map中的`pg_temp`显式地覆盖了。
</code></pre>
<h4 id="Current-Interval-or-Past-Interval"><a href="#Current-Interval-or-Past-Interval" class="headerlink" title="Current Interval or Past Interval"></a><em>Current Interval</em> or <em>Past Interval</em></h4><pre><code>A sequence of OSD map epochs during which the *Acting Set* and *Up
Set* for particular placement group do not change.
某一PG所在*Acting Set*和*Up Set*未更改时的一系列OSD map元版本。
</code></pre>
<h4 id="Primary-主-OSD"><a href="#Primary-主-OSD" class="headerlink" title="Primary (主 OSD)"></a><em>Primary</em> (<em>主 OSD</em>)</h4><pre><code>The member (and by convention first) of the *Acting Set*, that is
responsible for coordination peering, and is the only OSD that will
accept client-initiated writes to objects in a placement group.
*Acting Set*的成员（按惯例为第一个），它负责协调互联，并且是PG内惟一接受客户端初始写入的OSD。
</code></pre>
<h4 id="Replica-副本-OSD"><a href="#Replica-副本-OSD" class="headerlink" title="Replica (副本 OSD)"></a><em>Replica</em> (<em>副本 OSD</em>)</h4><pre><code>A non-primary OSD in the *Acting Set* for a placement group (and who
has been recognized as such and *activated* by the primary).
PG的*Acting Set*内不是主OSD的其它OSD ，它们被同等对待、由主OSD激活。
</code></pre>
<h4 id="Stray-彷徨-OSD"><a href="#Stray-彷徨-OSD" class="headerlink" title="Stray (彷徨 OSD)"></a><em>Stray</em> (<em>彷徨 OSD</em>)</h4><pre><code>An OSD that is not a member of the current *Acting Set*, but has not
yet been told that it can delete its copies of a particular
placement group.
不在PG的当前*Acting Set*中，但是还没有被告知要删除其副本的OSD。
</code></pre>
<h4 id="Recovery-恢复"><a href="#Recovery-恢复" class="headerlink" title="Recovery (恢复)"></a><em>Recovery</em> (<em>恢复</em>)</h4><pre><code>Ensuring that copies of all of the objects in a placement group are
on all of the OSDs in the *Acting Set*. Once *Peering* has been
performed, the *Primary* can start accepting write operations, and
*Recovery* can proceed in the background.
确保*Acting Set*内、PG中的所有对象的副本都存在于所有OSD上。
一旦互联完成，主OSD就以接受写操作，且恢复进程可在后台进行。
</code></pre>
<h4 id="PG-Info-PG-信息"><a href="#PG-Info-PG-信息" class="headerlink" title="PG Info (PG 信息)"></a><em>PG Info</em> (<em>PG 信息</em>)</h4><pre><code>Basic metadata about the placement group\&#39;s creation epoch, the
version for the most recent write to the placement group, *last
epoch started*, *last epoch clean*, and the beginning of the
*current interval*. Any inter-OSD communication about placement
groups includes the *PG Info*, such that any OSD that knows a
placement group exists (or once existed) also has a lower bound on
*last epoch clean* or *last epoch started*.
基本元数据，关于PG创建元版本、PG的最新写版本、最近的开始元版本（last epoch started）、
最近的干净元版本（last epoch clean）、和当前间隔（current interval）的起点。 
OSD间关于PG的任何通讯都包含PG Info，这样任何知道PG存在（或曾经存在）的OSD也必定有last epoch clean或last epoch started的下限。
</code></pre>
<h5 id="PG-Log-PG-日志"><a href="#PG-Log-PG-日志" class="headerlink" title="PG Log (PG 日志)"></a><em>PG Log</em> (<em>PG 日志</em>)</h5><pre><code>A list of recent updates made to objects in a placement group. Note
that these logs can be truncated after all OSDs in the *Acting Set*
have acknowledged up to a certain point.
PG内对象的一系列最近更新。需要注意的是这些日志在*Acting Set*内的所有OSD确认更新到某点后可以删除。
</code></pre>
<h4 id="Missing-Set-缺失集合"><a href="#Missing-Set-缺失集合" class="headerlink" title="Missing Set (缺失集合)"></a><em>Missing Set</em> (<em>缺失集合</em>)</h4><pre><code>Each OSD notes update log entries and if they imply updates to the
contents of an object, adds that object to a list of needed updates.
This list is called the *Missing Set* for that `&lt;OSD,PG&gt;`.
每个OSD都会记录更新日志，而且如果它们包含对象内容的更新，
会把那个对象加入一个待更新列表，这个列表叫做那个`&lt;OSD,PG&gt;`的*Missing Set*。
</code></pre>
<h4 id="Authoritative-History-权威历史"><a href="#Authoritative-History-权威历史" class="headerlink" title="Authoritative History (权威历史)"></a><em>Authoritative History</em> (<em>权威历史</em>)</h4><pre><code>A complete, and fully ordered set of operations that, if performed,
would bring an OSD\&#39;s copy of a placement group up to date.
一个完整、完全有序的操作集合，如果再次执行，可把一个OSD上的PG副本还原到最新。
</code></pre>
<h4 id="Epoch-元版本"><a href="#Epoch-元版本" class="headerlink" title="Epoch (元版本)"></a><em>Epoch</em> (<em>元版本</em>)</h4><pre><code>A (monotonically increasing) OSD map version number
一个（单调递增的）OSD map版本号。
</code></pre>
<h4 id="Last-Epoch-Start-最新起始元版本"><a href="#Last-Epoch-Start-最新起始元版本" class="headerlink" title="Last Epoch Start (最新起始元版本)"></a><em>Last Epoch Start</em> (<em>最新起始元版本</em>)</h4><pre><code>The last epoch at which all nodes in the *Acting Set* for a
particular placement group agreed on an *Authoritative History*. At
this point, *Peering* is deemed to have been successful.
 一最新元版本，在这点上，PG所对应*Acting Set*内的所有节点都对权威历史达成了一致、
 并且互联被认为成功了。
</code></pre>
<h4 id="up-thru-领导拍板"><a href="#up-thru-领导拍板" class="headerlink" title="up_thru (领导拍板)"></a><em>up_thru</em> (<em>领导拍板</em>)</h4><pre><code>Before a *Primary* can successfully complete the *Peering* process,
it must inform a monitor that is alive through the current OSD map
*Epoch* by having the monitor set its *up\_thru* in the osd map.
This helps *Peering* ignore previous *Acting Sets* for which
*Peering* never completed after certain sequences of failures, such
as the second interval below:

-   *acting set* = \[A,B\]
-   *acting set* = \[A\]
-   *acting set* = \[\] very shortly after (e.g., simultaneous
    failure, but staggered detection)
-   *acting set* = \[B\] (B restarts, A does not)
主OSD要想成功完成互联，它必须通过当前OSD map元版本通知一个Monitor，让此Monitor在OSD map中设置其up_thru。
这会使互联进程忽略之前的*Acting Set*，因为它经历特定顺序的失败后一直不能互联，比如像下面的第二周期：

acting set = [A,B]
acting set = [A]
acting set = [] 之后很短时间（例如同时失败、但探测是交叉的）
acting set = [B] （ B 重启了、但 A 没有）
</code></pre>
<h4 id="Last-Epoch-Clean-最新干净元版本"><a href="#Last-Epoch-Clean-最新干净元版本" class="headerlink" title="Last Epoch Clean (最新干净元版本)"></a><em>Last Epoch Clean</em> (<em>最新干净元版本</em>)</h4><pre><code>The last *Epoch* at which all nodes in the *Acting set* for a
particular placement group were completely up to date (both
placement group logs and object contents). At this point, *recovery*
is deemed to have been completed.
最近的Epoch，这时某一特定PG所在*Acting Set*内的所有节点都全部更新了（包括PG日志和对象内容）。
在这点上，恢复被认为已完成。
</code></pre>
<p>参考：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/ceph/ceph/blob/v14.0.0/doc/rados/operations/pg-states.rst">https://github.com/ceph/ceph/blob/v14.0.0/doc/rados/operations/pg-states.rst</a></li>
<li><a target="_blank" rel="noopener" href="http://docs.ceph.org.cn/rados/operations/pg-states/">http://docs.ceph.org.cn/rados/operations/pg-states/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ceph/ceph/blob/v14.0.0/doc/rados/operations/pg-concepts.rst">https://github.com/ceph/ceph/blob/v14.0.0/doc/rados/operations/pg-concepts.rst</a></li>
<li><a target="_blank" rel="noopener" href="http://docs.ceph.org.cn/rados/operations/pg-concepts/">http://docs.ceph.org.cn/rados/operations/pg-concepts/</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer"><div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center;">
  <img id="wechat_subscriber_qcode" src="/images/wechat-qrcode.jpg" alt="陈孚 wechat" style="width: 200px; max-width: 100%;">
  <div>新注册了公众号，同步更新，长按关注，可以第一时间收到推送</div>
</div>

          <div class="post-tags">
              <a href="/tags/Ceph/" rel="tag"># Ceph</a>
              <a href="/tags/PG-States/" rel="tag"># PG States</a>
              <a href="/tags/PG-Concepts/" rel="tag"># PG Concepts</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2018/05/17/kube-dns-spec/" rel="prev" title="Kubernetes DNS-Based Service Discovery 翻译">
                  <i class="fa fa-angle-left"></i> Kubernetes DNS-Based Service Discovery 翻译
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2018/08/07/upgrade-harbor/" rel="next" title="Harbor折腾升级记">
                  Harbor折腾升级记 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">陈孚</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://fastly.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.31/dist/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>



  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"C0reFast/c0refast.github.io","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
